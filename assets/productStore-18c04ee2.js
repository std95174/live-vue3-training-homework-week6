import{j as r,f as s}from"./index-718f8dd3.js";const c=r("productStore",{state:()=>({products:[],selectedProduct:{},carts:[]}),actions:{selectProduct(t){this.selectedProduct=t},async getProducts(){const{data:t}=await s.get("https://vue3-course-api.hexschool.io/v2/api/frank-hex-api/products/all");this.products=t.products.map(a=>({...a,isCartLoading:!1,isInfoLoading:!1}))},async addProductToCart(t,a){t.isCartLoading=!0;const e=this.carts.findIndex(i=>i.product_id===t.id);if(e!==-1){await this.updateCartItem(this.carts[e],this.carts[e].qty+a),t.isCartLoading=!1;return}await s.post("https://vue3-course-api.hexschool.io/v2/api/frank-hex-api/cart",{data:{product_id:t.id,qty:a}}),await this.getCarts(),t.isCartLoading=!1,window.alert("已加入購物車")},async clearCarts(){await s.delete("https://vue3-course-api.hexschool.io/v2/api/frank-hex-api/carts"),await this.getCarts(),window.alert("購物車已清空")},async removeCartItem(t){await s.delete(`https://vue3-course-api.hexschool.io/v2/api/frank-hex-api/cart/${t.id}`),await this.getCarts(),window.alert("已從購物車移除")},async getCarts(){try{const{data:t}=await s.get("https://vue3-course-api.hexschool.io/v2/api/frank-hex-api/cart");this.carts=t.data.carts}catch(t){throw t.response.status===400&&(this.carts=[]),t}},async updateCartItem(t,a){if(a===0){await this.removeCartItem(t),await this.getCarts();return}await s.put(`https://vue3-course-api.hexschool.io/v2/api/frank-hex-api/cart/${t.id}`,{data:{product_id:t.product_id,qty:a}}),await this.getCarts(),window.alert("已更新購物車")},async submitOrder(t){if(this.carts.length===0){window.alert("購物車是空的");return}try{await s.post("https://vue3-course-api.hexschool.io/v2/api/frank-hex-api/order",{data:t}),await this.getCarts(),window.alert("訂單已送出")}catch(a){window.alert(a.response.data.message)}}},getters:{}});export{c as p};
