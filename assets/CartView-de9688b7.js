import{_ as g,l as b,g as p,o as r,c as n,h as a,i as $,b as e,n as u,w as y,v as V,e as C,d as x,m as v,a as q,F as I,r as L,t as _}from"./index-f86386bb.js";import{p as f}from"./productStore-5f5681ed.js";const F={name:"OrderForm",data(){return{order:{user:{name:"",email:"",tel:"",address:""},message:""},isLoading:!1}},methods:{async submitOrder(l){b().setIsLoading(!0);try{await f().submitOrder(l),this.$refs.form.resetForm()}catch(t){console.log(t)}finally{b().setIsLoading(!1)}}}},U={class:"my-5 row justify-content-center"},S={class:"mb-3"},O=e("label",{for:"email",class:"form-label"},"Email",-1),N={class:"mb-3"},B=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),E={class:"mb-3"},D=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),T={class:"mb-3"},j=e("label",{for:"address",class:"form-label"},"收件人地址",-1),z={class:"mb-3"},A=e("label",{for:"message",class:"form-label"},"留言",-1),M={class:"text-end"},G=["disabled"],H={key:0,class:"fas fa-spinner fa-pulse"};function J(l,t,k,w,o,h){const c=p("v-field"),s=p("error-message"),m=p("v-form");return r(),n("div",U,[a(m,{ref:"form",class:"col-md-6",onSubmit:t[5]||(t[5]=d=>h.submitOrder(o.order))},{default:$(({errors:d})=>[e("div",S,[O,a(c,{id:"email",name:"email",type:"email",class:u(["form-control",{"is-invalid":d.email}]),placeholder:"請輸入 Email",rules:"required|email",modelValue:o.order.user.email,"onUpdate:modelValue":t[0]||(t[0]=i=>o.order.user.email=i)},null,8,["class","modelValue"]),a(s,{name:"email",class:"invalid-feedback"})]),e("div",N,[B,a(c,{id:"name",name:"姓名",type:"text",class:u(["form-control",{"is-invalid":d.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:o.order.user.name,"onUpdate:modelValue":t[1]||(t[1]=i=>o.order.user.name=i)},null,8,["class","modelValue"]),a(s,{name:"姓名",class:"invalid-feedback"})]),e("div",E,[D,a(c,{id:"tel",name:"電話",type:"text",class:u(["form-control",{"is-invalid":d.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10|tw-phone-number",modelValue:o.order.user.tel,"onUpdate:modelValue":t[2]||(t[2]=i=>o.order.user.tel=i)},null,8,["class","modelValue"]),a(s,{name:"電話",class:"invalid-feedback"})]),e("div",T,[j,a(c,{id:"address",name:"地址",type:"text",class:u(["form-control",{"is-invalid":d.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:o.order.user.address,"onUpdate:modelValue":t[3]||(t[3]=i=>o.order.user.address=i)},null,8,["class","modelValue"]),a(s,{name:"地址",class:"invalid-feedback"})]),e("div",z,[A,y(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[4]||(t[4]=i=>o.order.message=i)},null,512),[[V,o.order.message]])]),e("div",M,[e("button",{type:"submit",class:"btn btn-danger",disabled:o.isLoading},[o.isLoading?(r(),n("i",H)):C("",!0),x(" 送出訂單 ")],8,G)])]),_:1},512)])}const K=g(F,[["render",J]]),P={name:"ShoppingCart",components:{OrderForm:K},methods:{...v(f,["clearCarts","getCarts","removeCartItem","updateCartItem"]),...v(b,["setIsLoading"])},async mounted(){this.setIsLoading(!0),await this.getCarts(),this.setIsLoading(!1)},computed:{...q(f,["carts"])}},Q={class:"mt-3"},R={key:0,class:"text-end"},W={key:1,class:"text-center text-decoration-underline"},X={key:2,class:"table align-middle"},Y=e("thead",null,[e("tr",null,[e("th"),e("th",{class:"w-25"},"商品名稱"),e("th",{class:"w-25"},"數量/單位"),e("th",{class:"w-25"},"小計")])],-1),Z=["onClick"],ee={class:"align-middle"},se={class:"input-group"},te=["onUpdate:modelValue","onFocusout"],oe={class:"input-group-text",id:"basic-addon2"},le={key:0},ae={key:1};function re(l,t,k,w,o,h){const c=p("order-form");return r(),n("div",Q,[l.carts.length!==0?(r(),n("div",R,[e("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=(...s)=>l.clearCarts&&l.clearCarts(...s))},"清空購物車")])):C("",!0),l.carts.length===0?(r(),n("div",W," 購物車還是空的喔！ ")):(r(),n("table",X,[Y,e("tbody",null,[(r(!0),n(I,null,L(l.carts,s=>{var m;return r(),n("tr",{key:s.id},[e("td",null,[e("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:d=>l.removeCartItem(s)},null,8,Z)]),e("td",null,_(s.product.title),1),e("td",ee,[e("div",se,[y(e("input",{type:"number",class:"form-control",placeholder:"請輸入購買數量","aria-label":"購買數量","aria-describedby":"basic-addon2",min:"0","onUpdate:modelValue":d=>s.qty=d,onFocusout:d=>l.updateCartItem(s,s.qty)},null,40,te),[[V,s.qty,void 0,{number:!0}]]),e("span",oe,_((m=s.product)==null?void 0:m.unit),1)])]),e("td",null,[s.qty===0?(r(),n("span",le,"將自購物車中移除")):(r(),n("span",ae,_(s.product.price*s.qty)+" 元 ",1))])])}),128))])])),a(c)])}const ie=g(P,[["render",re]]);export{ie as default};
